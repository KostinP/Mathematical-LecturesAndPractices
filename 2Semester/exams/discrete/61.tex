\documentclass[discrete.tex]{subfiles}

\begin{document}
  \section{Числа Каталана}
  \begin{task}
    Предположим, нужно вычислить сумму $S_0+S_1+...+S_n$ и можно складывать любые два рядом стоящих числа и ставить результат на их место. Требуется найти число различных последовательностей действий (числа Каталана)
  \end{task}

  \begin{sol}
    Обозначим искомое число способов через $c_n$. Чсно, что последнее вычисление в любом случае будет сложением сумм для двух последовательных подмножеств вида $0:k$ и $(k+1):n$, и схемы с различными k принципиально различны. Но для данного k мы должны иметь $c_k$ вариантов левой части и $c_{n-k-1}$ вариантов правой части, так что
    \[c_n = \sum_{k=0}^{n-1} c_k c_{n-k-1},\q \text{где $c_0=1$}\]
    Введем производящую функцию:
    \[C(x) = \sum_{n=0}^{\infty} c_n x^n\]
    и рассмотрим:
    \[C^2(x) = \sum_{m=0}^{\infty} c_m x^m \cdot \sum_{n=0}^{\infty} c_n x^n = \sum_{m,n=0}^{\infty} c_m c_n x^{m+n} = \sum_{r=0}^{\infty} \sum_{m=0}^r c_m c_{r-m} x^r = \sum_{r=0}^{\infty} c_{r+1} x^r\]
    \[\Ra C(x) = x C^2(x) + 1\]
    \[\Ra C(x) = \frac{1 \pm \sqrt{1-4x}}{2x}\]
    По формуле тейлора для функции $f(x) = \sqrt{1-4x}$ получим решение
    \[\frac{d^k}{d x^k} (1-4x)^{\frac{1}{2}} = \frac{1}{2} (\frac{1}{2}-1)...(\frac{1}{2-k+1}) (1-4x)^{\frac{1}{2}-k}(-4)^k=\]
    \[=-2^k \cdot 1 \cdot 3 ... (2k-3)(1-4x)^{\frac{1}{2}-k} = -2(k-1)! C_{2k-2}^{k-1} x^k\]
    Подставляя этот ряд в формулу для $C(x)$, мы должны сначала выбрать знак перед квадратным корнем (знак минус нас устраивает больше) и провести необходимые выкладки. Получаем:
    \[C(x) = \sum_{k=1}^{\infty} \frac{1}{k} C_{2k-2}^{k-1} x^{k-1} = \sum_{k=0}^{\infty} \frac{1}{k+1} C_{2k}^k x^k\]
  \end{sol}
\end{document}

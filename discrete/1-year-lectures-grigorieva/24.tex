\documentclass[discrete.tex]{subfiles}

\begin{document}
  \section{Задача о максимальном совпадении двух строк}

  \begin{task}
    Пусть заданы две последовательности (строки) $a[1:m]$ и $b[1:n]$, требуется найти их максимальное совпадение. Будем также решать подзадачи с меньшими строками $a[1:k]$ и $b[1:l]$, где $k \in 1:m$ и $l \in 1:n$. Задачу с такими параметрами будем называть задачей $(k,l)$ а максимальную длину последовательности в ней обозначим через $v(k,l)$ (искомая задача становится задачей $(m,n)$ и требуется найти $v(m,n)$)

    Сформируем из искомых значений матрицу $v[1:m,1:n]$. Начнем с того, что решения при $k=1$ и при $l=1$ находятся сразу:
    \[v[1,1] = \begin{cases}
      1, & \text{если }a[1]=b[1]\\
      0 & \text{иначе}
    \end{cases}\]
    \[v[k,1] = \begin{cases}
      1, & \text{если }v[k-1,1]=1 \text{ или } a[k]=b[1]\\
      0, & \text{иначе}
    \end{cases}\]
    \[v[1,l] = \begin{cases}
      1, & \text{если }v[1,l-1]=1 \text{ или } a[1]=b[l]\\
      0 & \text{иначе}
    \end{cases}\]
    Для произвольного элемента матрицы, "отодвинутого"{} от левого верхнего края, получаем:
    \[v[k,l] = \begin{cases}
      1 + v[k-1,l-1], & \text{если }a[k]=b[l]\\
      \max\{v[k-1,l],v[k,l-1]\} & \text{иначе}
    \end{cases}\]
  \end{task}

  \begin{example}[bcaccd и abaccbd] \ \\
    \begin{tabular}{c|c|cccccccc}
        &   & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
        \hline
        &   & a & b & a & c & c & b & c & d\\
      \hline
      1 & b & 0 & \bfseries 1 & 1 & 1 & 1 & 1 & 1 & 1\\
      2 & c & 0 & 1 & 1 & \bfseries 2 & 2 & 2 & 2 & 2\\
      3 & a & \bfseries 1 & 1 & \bfseries 2 & 2 & 2 & 2 & 2 & 2\\
      4 & c & 1 & 1 & 2 & \bfseries 3 & 3 & 3 & 3 & 3\\
      5 & c & 1 & 1 & 2 & 3 & \bfseries 4 & 4 & 4 & 4\\
      6 & d & 1 & 1 & 2 & 3 & 4 & 4 & 4 & \bfseries 5
    \end{tabular}
  \end{example}
\end{document}
